{%extends 'base.html'%}
{%load static%}
{%block title%}Trikada | Checkout Page{%endblock%}
{%block body%}
<style>
    body{
        background:rgb(241, 251, 255);
    }
    .section1{
        min-height:100vh;
        height:auto;
        width:100%;
  position: absolute;
     }
    .your-items{
        height:auto;
        width:60%;
        margin-left:20%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    margin-top:80px;
    background:#fff;
    }
    .your-items h1{
        text-align:center;
        font-size:20px;
        padding-top:10px;
        color:#2d6cdf;
    }
    .your-items img{
        background:#2d6cdf;
        z-index:2;
    }
    .your-items .total{
        text-align: center;
        line-height: 30px;
     font-size:15px;
     font-weight: bold;
     color:#2d6cdf;
     border-top:2px rgba(0,0,0,0.1) solid;
     word-spacing: 4px;
    }
    .total #total{
        font-style: normal;
        color:#333;
    }
    #items{
        margin-top:10px;
        list-style: none;
        position: relative;
    }
    #items p{
        text-align: center;
        line-height: 30px;
        border-top:2px rgba(0,0,0,0.1) solid;
        color:red;
    }
    #items .item{
        height:30px;
        border-top:2px rgba(0,0,0,0.1) solid;
        line-height: 30px;
        text-align: center;
        font-family: 'Montserrat', sans-serif;
  font-weight: bold;
  font-size:15px;
  color:#333;
     }
     #items i{
         font-style: normal;
         position: absolute;
         left:0;
         width:120px;
         background:#2d6cdf;
         color:#fff;
         font-size:15px;
     }
     #items span{
         position: absolute;
         right:0;
         background:darkorange;
         font-size:15px;
         color:#fff;
         width:30px;
             }
  .shipping{
      height:auto;
      width:60%;
      margin-left:20%;
      background:#fff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top:20px;
  }        
  .shipping h1{
      text-align:center;
      font-size:20px;
      color:#2d6cdf;
      padding-top:10px;
  }
  .shipping form{
      padding:10px 20px;
       } 
  .shipping form label{
      font-size:15px;
      color:#2d6cdf;
      font-weight: 400;
      }   
  .shipping form label i{
    font-family: 'Montserrat', sans-serif;
 color:red;
  }
  label[for="email"],label[for="alphone"]{
      position: absolute;
      left:51%;
  }
  .shipping input{
      font-size:15px;
      font-family: 'Montserrat', sans-serif;
  text-align: center;
  color:#333;
  width:100%;
  font-weight: bold;
  border:none;
     border-bottom:#2d6cdf 1px solid;
  margin-bottom: 10px;
  outline: none;
  }    
 #name,#email,#phone,#alphone{
     width:49%;
     border:none;
     border-bottom:#2d6cdf 1px solid;
  margin-bottom: 10px;
 } 
 #phone{
     margin-bottom:20px;
 }
 #email,#alphone{
     margin-left:1%;
  }
  #city,#pincode{
      height:30px;
      width:120px;
      border:#2d6cdf 1px solid;
      border-radius:5px;
      margin:10px 0;
  }
  #city{
      margin-right:30px;
  }
#state{
    height:30px;
    width:100%;
    border-radius:5px;
    font-family: 'Spartan', sans-serif;
    color:#2d6cdf;
    font-weight: 400;
    font-size:15px;
    border:#2d6cdf 1px solid;
    margin:5px 0;
}
.shipping h2{
    text-align: center;
   }
   .shipping h2 button{
   padding:5px 20px;
   color:#fff;
   background:#2d6cdf;
border:none;
box-shadow: 0 2px 4px rgba(0,0,0,0.2);
font-size:15px;   
font-family: 'Spartan', sans-serif;
cursor: pointer;
margin-top:10px;
   }
   #cod,#pay-now{
       width:auto;
       margin-top:20px;
   }
   label[for="cod"]{
       margin-right:20px;
   }
   /* Media query starts */
   /* Max-width:1080px starts */
   @media only screen and (max-width:1080px){
  .your-items{
      width:80%;
      margin-left:10%;
  }
  .shipping{
      width:80%;
      margin-left:10%;
  }
   }
   /* Max-width:992px strats */
   @media only screen and (max-width:992px){
       .your-items{
           margin-top:100px;
       }
   }
   /*Max-width:650px starts  */
   @media only screen and (max-width:650px){
       .your-items{
           width:90%;
           margin-left:5%;
               }
    .your-items h1{
        font-size:15px;
    }         
    .your-items p{
        font-size:12px;
    }  
   #items .item{
 font-size:14px;
   }
   #items i{
       font-size:14px;
       width:100px;
   }
   #items span{
       font-size:14px;
   }
   .shipping{
       width:90%;
       margin-left:5%;
   }
   .shipping h1{
       font-size:15px;
   }
   .shipping form label{
       font-size:12px;
   }
   .shipping input{
       font-size:12px;
   }
   #city,#pincode{
       height:25px;
       width:100px;
   }
   #state{
       height:25px;
       font-size:12px;
   }
   }
   /* Max-width:480px starts */
   @media only screen and (max-width:480px){
       .your-items{
           width:95%;
           margin-left:2.5%;
           margin-top:100px;
       }
     .your-items h1{
         line-height:20px;
         font-size:14px;
         padding-top:5px;
     }  
     .your-items .total{
         line-height:20px;
         font-size:12px;
     }
  #items{
      margin-top:5px;
  }
  #items .item{
      height:20px;
      font-size:10px;
      line-height:20px;
  }
  #items i{
      font-size:11px;
      width:60px;
  }
  #items span{
      font-size:11px;
  }
  .shipping{
      width:95%;
      margin-left:2.5%;
  }
  .shipping h1{
      font-size:12px;
  }
  .shipping form{
      padding:10px;
  }
#name,#email,#phone,#alphone{
    width:48%;
}
.shipping form input{
    font-size:10px;
}
#city,#pincode{
    height:20px;
    width:60px;
}
#state{
    height:20px;
    font-size:10px;
}
#code,#pay-now{
    margin-top:10px;
}
.shipping h2 button{
    padding:3px 15px;
    font-size:12px;
}
   }
</style>
{%include 'navbar.html'%}
<section id="section1" class="section1">
<div class="your-items">
<h1>Your Items</h1>
<ul id="items"></ul>
<p class="total">Your cart total is <i id="total">₹ 0</i></p>
</div>
<div class="shipping">
    <h1>Shipping Details</h1>
 <form action="/checkout_page" method="post">
    {% csrf_token %}
    <input id="totalInput" type="number" readonly hidden name="total" required>
    <input id="totalItems" type="hidden" name="items" required>
<label for="name">Name <i>*</i> :</label><label for="email">Email <i>*</i> :</label><br>
<input id="name" type="text" name="name" required value="{%if customer%}{{request.user.first_name}} {{request.user.last_name}}{%else%}{%endif%}">
<input id="email" type="email" name="email" required value="{%if customer%}{{request.user.email}}{%else%}{%endif%}"><br>
<label for="phone">Phone no. <i>*</i> :</label>
<label for="alphone">Alternative Phone no. :</label><br>
<input id="phone" type="number" name="phone" required  value={{customer.phone}}>
<input id="alphone" type="number" name="alphone"><br>
<label>Address <i>*</i> :</label><br>
<input type="text" name="address-line-1" placeholder="Address-line-1" required value="{{customer.addressline1}}"><br>
<input type="text" name="address-line-2" placeholder="Address-line-2" value="{{customer.addressline2}}"><br>
<label for="landmark">Landmark :</label><br>
<input type="text" name="landmark" placeholder="Known Place like School, Building, etc."><br>
<label for="city">City <i>*</i> :</label>
<input type="text" id="city" name="city" required value="{{customer.city}}">
<label for="pincode">Pincode <i>*</i> :</label>
<input type="number" id="pincode" name="pincode" value="{{customer.pincode}}" required><br>
<label for="state">State <i>*</i> :</label><br>
<select name="state" id="state" class="form-control" required>
    <option value="" selected disabled>--Select State--</option>   
   <option value="Andhra Pradesh">Andhra Pradesh</option>
   <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
   <option value="Arunachal Pradesh">Arunachal Pradesh</option>
   <option value="Assam">Assam</option>
   <option value="Bihar">Bihar</option>
   <option value="Chandigarh">Chandigarh</option>
   <option value="Chhattisgarh">Chhattisgarh</option>
   <option value="Dadar and Nagar Haveli">Dadar and Nagar Haveli</option>
   <option value="Daman and Diu">Daman and Diu</option>
   <option value="Delhi">Delhi</option>
   <option value="Lakshadweep">Lakshadweep</option>
   <option value="Puducherry">Puducherry</option>
   <option value="Goa">Goa</option>
   <option value="Gujarat">Gujarat</option>
   <option value="Haryana">Haryana</option>
   <option value="Himachal Pradesh">Himachal Pradesh</option>
   <option value="Jammu and Kashmir">Jammu and Kashmir</option>
   <option value="Jharkhand">Jharkhand</option>
   <option value="Karnataka">Karnataka</option>
   <option value="Kerala">Kerala</option>
   <option value="Madhya Pradesh">Madhya Pradesh</option>
   <option value="Maharashtra">Maharashtra</option>
   <option value="Manipur">Manipur</option>
   <option value="Meghalaya">Meghalaya</option>
   <option value="Mizoram">Mizoram</option>
   <option value="Nagaland">Nagaland</option>
   <option value="Odisha">Odisha</option>
   <option value="Punjab">Punjab</option>
   <option value="Rajasthan">Rajasthan</option>
   <option value="Sikkim">Sikkim</option>
   <option value="Tamil Nadu">Tamil Nadu</option>
   <option value="Telangana">Telangana</option>
   <option value="Tripura">Tripura</option>
   <option value="Uttar Pradesh">Uttar Pradesh</option>
   <option value="Uttarakhand">Uttarakhand</option>
   <option value="West Bengal">West Bengal</option>
   </select>
   <input id="cod" type="radio" name="payment" value="COD" required>
   <label for="cod">Cash on Delivery</label>
   <input id="pay-now" type="radio" required name="payment" value="paynow">
   <label for="pay-now">Pay Now</label>
   <br> 
<h2><button type="submit">Place Order</button></h2>
</form>   
</div>
<p hidden id="error"></p>
</section>
<p style="font-size:12px;color:#333;font-weight:400; position:absolute;bottom:10px;">© 2020 Trikada</p>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
  <script>
     if (localStorage.getItem('cart')==null){
    var cart = {};
}else{
   cart = JSON.parse(localStorage.getItem('cart'));
}
if($.isEmptyObject(cart)){
    $('#items').append('<p>You have not selected any item yet!</p>')
}else{
    let totalprice = 0;
    let totalItems = "";
    let i = 1;
    for (item in cart){
        let price = cart[item][2];
        let name = cart[item][1];
        let qty = cart[item][0];
        if(qty>0){
        itemShow = `<li class="item"><i>₹ ${price}</i>${name.slice(0,40)}..<span>${qty}</span></li>`;
      $('#items').append(itemShow);
     totalprice = totalprice + parseInt(price)*parseInt(qty);
        document.getElementById('total').innerHTML = "₹ "+totalprice;
     $('#totalInput').val(totalprice)
        }
         else{
                $('#items').append('<p>You have not selected any item yet!</p>')
           }
         }
}
$('#totalItems').attr('value',JSON.stringify(cart))
document.getElementById('cart').innerHTML = Object.keys(cart).length;

$('form').submit(function(){
    localStorage.clear(); 
        cart = {};
    localStorage.setItem('cart',JSON.stringify(cart));
    document.getElementById('cart').innerHTML = Object.keys(cart).length;
    
})

  </script>
{%endblock%}